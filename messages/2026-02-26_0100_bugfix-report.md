# Bug Fix Report — 2026-02-26

## 인게임 던전 버그 수정

| # | 문제 | 수정 내용 | 상태 |
|---|------|----------|------|
| 0 | 던전 진입 시 팝업 겹침 | 배너 depth를 600+로 상향 (DOM HUD 500 위) | ✅ |
| 1 | 레스큐 후 게임 멈춤 | allEntities에서 적 제거 + TurnManager.forceIdle() 추가 | ✅ |
| 2 | 하단 버튼 겹침 (줍기/스킬) | DOM HUD 레이아웃 전면 재설계: 스킬 1열 → D-pad 위, 액션 버튼 그 위 | ✅ |
| 3 | 스킬 설명 안 보임 | DOM skillDescBox 추가, 스킬 클릭 시 상단에 3초간 설명 표시 | ✅ |
| 4 | D-pad 아래 UI 짤림 | Auto 버튼 위치 조정, 로그/체인 HUD 재배치 | ✅ |
| 5 | HUD 텍스트 가려짐 | 로그 텍스트 Y 위치 230px 위로 이동, textShadow 추가 | ✅ |
| 6 | MAP-햄버거 겹침 | 햄버거 버튼을 우상단 고정 위치(360-20, 72)로 이동 | ✅ |
| 7 | 기브업 → 까만화면 | fadeOut 완료 콜백(camerafadeoutcomplete) 사용 + DOM HUD 정리 | ✅ |
| 8 | 가방/옵션 열어도 스킬 클릭 가능 | setDomHudInteractive() 함수 추가, 모든 overlay open/close에 연동 | ✅ |
| 9 | 다음층 → 까만화면 | advanceFloor에서 camerafadeoutcomplete 콜백 + DOM HUD destroy | ✅ |
| 10 | 이어하기 시 팀원 소실 | DungeonSaveData에 allies/belly 필드 추가, save/load 양방향 연결 | ✅ |

## 로비 버그 수정

| # | 문제 | 수정 내용 | 상태 |
|---|------|----------|------|
| 0-1 | Back to Town 안 눌림 | 14개 씬 전체: 순수 텍스트 → styled rectangle 버튼으로 교체 | ✅ |
| 2 | 탭 타이틀-콘텐츠 너무 가까움 | Prep 탭 버튼 간격 48→50px, 시작 Y 58→62 | ✅ |
| 3 | 스타터/NPC 멈춰 보임 | idle 애니메이션 생성 및 자동 재생 (frameRate: 6, repeat: -1) | ✅ |
| 4 | [텍스트] 형태 버튼 잔존 | 14개 씬의 `[Back to Town]` / `[Back]` → 스타일 버튼 전환 | ✅ |

## 변경 파일 목록

### Core
- `src/ui/dom-hud.ts` — 전면 재작성 (레이아웃, skillDescBox, setDomHudInteractive)
- `src/core/turn-manager.ts` — forceIdle() 메서드 추가
- `src/core/save-system.ts` — DungeonSaveData에 allies/belly 필드 추가

### Scenes (Dungeon)
- `src/scenes/DungeonScene.ts` — 15개 이상의 수정 사항

### Scenes (Lobby & Other)
- `src/scenes/HubScene.ts` — continueSave에 allies/belly 전달, idle 애니메이션
- `src/scenes/AchievementScene.ts` — styled back button
- `src/scenes/AbilityUpgradeScene.ts` — styled back button (addBackButton 메서드)
- `src/scenes/CraftingScene.ts` — styled back button
- `src/scenes/DungeonPreviewScene.ts` — styled back button
- `src/scenes/ForgeScene.ts` — styled back button
- `src/scenes/HeldItemScene.ts` — styled back button
- `src/scenes/HelpScene.ts` — styled back button
- `src/scenes/JournalScene.ts` — styled back button
- `src/scenes/LeaderboardScene.ts` — styled back button
- `src/scenes/MoveTutorScene.ts` — styled back button
- `src/scenes/PokedexScene.ts` — styled back button
- `src/scenes/QuestBoardScene.ts` — styled back button
- `src/scenes/SettingsScene.ts` — styled back button (위치 변경)
- `src/scenes/TalentTreeScene.ts` — styled back button (addBackButton 메서드)
- `src/scenes/UpgradeScene.ts` — styled back button

## 빌드 결과
- TypeScript 에러: 0개
- Vite 빌드: 성공 (2,330KB bundle)
