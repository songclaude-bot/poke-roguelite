# 포켓몬 미스터리 던전 로그라이트 — 상세 기획서 (GDD) v2

> PMD 스타일 턴제 던전 크롤러 / 모바일 웹 / Phaser 3 + rot.js
> 비상업적 팬게임 (GPL v3 + CC BY-NC 4.0)

---

## 1. 게임 개요

### 한 줄 요약
"포켓몬을 모으고 키우며 랜덤 던전을 탐험하는 턴제 로그라이트"

### 핵심 차별점
- **Shattered Pixel Dungeon**의 간결한 모바일 UX
- **PMD**의 포켓몬 세계관 + 동료 모집
- **Risk of Rain 2**의 도전과제 기반 해금 시스템

### 플랫폼
- 모바일 웹 (세로 모드, PWA)
- Phaser 3 렌더링 + rot.js 던전 생성

### 한 판 플레이 시간: 10분
- 모든 던전 공통 **7층** 구조 (6층 탐험 + 1층 보스)
- 층당 목표 소요: ~1.5분 (탐색 + 전투 + 아이템)
- 보스전: ~1.5분
- 합계: 약 10분

> 난이도는 층 수가 아니라 **적의 레벨/밀도/구성**으로 조절한다.
> 이를 통해 "초반 던전 = 쉬운 10분", "후반 던전 = 어려운 10분"을 구현.

---

## 2. 핵심 게임 루프

```
 ┌─────────────────────────────────────────────────────────┐
 │                      마을 (허브)                         │
 │  [던전 선택] [팀 편성] [아이템 정리] [도전과제 확인]      │
 └────────────────────────┬────────────────────────────────┘
                          ▼
 ┌─────────────────────────────────────────────────────────┐
 │                 던전 (7층, ~10분)                        │
 │                                                         │
 │  1F~6F: 탐색 → 전투 → 아이템 → 계단                    │
 │  7F: 보스전                                             │
 └────────────┬───────────────────────┬────────────────────┘
              ▼                       ▼
         클리어 성공               전멸 (사망)
         ┌─────────┐             ┌─────────┐
         │보상 전액 │             │보상 일부 │
         │모집 확정 │             │도전과제는 │
         │도전과제○ │             │달성 유지  │
         └────┬────┘             └────┬────┘
              └──────────┬────────────┘
                         ▼
                 마을 귀환 + 해금 반영
```

### 데드엔드 방지 원칙

1. **절대 막히지 않는 진행**: 어떤 던전이든 스타터 1마리로 클리어 가능하도록 밸런싱. 동료/아이템은 "더 쉽게" 해줄 뿐 "필수"가 아님
2. **사망 패널티 최소화**: 죽어도 잃는 것은 "그 런에서 주운 소모 아이템"뿐. 포켓몬, 장비, 골드(50%), 도전과제 진행도는 영구 유지
3. **난이도 안전장치**: 3연속 사망 시 해당 던전에 "구조대 모드" 제안 (적 레벨 -20%, 아이템 드랍 +50%)
4. **탈출 보장**: 모든 층에 "탈출오브" 최소 1개 보장 배치. 위험하면 언제든 마을로 귀환 가능 (해당 런 보상 50%만 획득)

---

## 3. 턴 시스템 & 이동

### 기본 규칙
- **1턴 = 1행동**: 이동 1칸, 기술 사용, 아이템 사용, 대기 중 택1
- 내 턴 → 동료 AI 턴 → 적 턴 (순차)
- 속도(Speed) 높으면 1턴에 2회 행동 가능 (Speed > 100)

### 이동
- 8방향 이동 (상하좌우 + 대각선)
- 조작: 이동할 타일 탭 or 스와이프 방향
- **자동 이동**: 길게 탭하면 적 만날 때까지 자동 전진 (층당 탐색 시간 단축 핵심)

### 타일 종류 (DTEF 시스템 활용)
| 타일 | TerrainType | 설명 |
|------|-------------|------|
| 바닥 | GROUND | 누구나 이동 가능 |
| 벽 | WALL | 이동 불가. 고스트 타입은 통과 가능 (턴당 배고픔 5배 소모) |
| 물 | WATER | 물/비행 타입만 이동 가능. 나머지는 못 지나감 |

### 시야 (FOV)
- rot.js의 FOV 알고리즘 사용
- 방 안: 방 전체 보임
- 복도: 전방 2칸만 보임

---

## 4. 전투 시스템

### 기본 공격
- 인접한 적에게 자동 기본 공격 (해당 방향 탭)
- 데미지 = ATK × 타입 보정 - DEF × 0.05

### 기술 시스템 (최대 4개 장착)
- PP 소모 방식: 각 기술에 PP가 있고, 사용하면 감소
- PP 회복: 이동 시 1턴당 1PP 자연 회복 / 맥스업씨 등 아이템
- 기술 범위 패턴:

| 범위 유형 | 설명 | 예시 |
|-----------|------|------|
| 정면 1칸 | 기본 근접 | 할퀴기, 몸통박치기 |
| 정면 직선 | 원거리 관통 | 냉동빔, 10만볼트 |
| 주변 8칸 | 범위 공격 | 지진, 파도타기 |
| 방 전체 | 광역 | 열풍, 붐볼 |
| 자신 | 버프/회복 | 칼춤, 회복 |
| 정면 2칸 | 중거리 | 불꽃세례 |

### 타입 상성 (PMD 방식 — 압축된 배율)
| 상성 | 배율 | 이유 |
|------|------|------|
| 효과 굉장 | ×1.3 | 원작 ×2.0은 원킬 너무 쉬움 |
| 보통 | ×1.0 | - |
| 효과 별로 | ×0.8 | 약해도 무의미하진 않음 |
| 면역 | ×0.5 | 완전 면역은 없음 (PMD 전통) |

### 상태이상 (핵심 선별)
**디버프** (8종):
- 화상: 매 턴 HP 감소, ATK 저하
- 독: 매 턴 HP 감소 (맹독은 누적)
- 마비: 50% 확률로 행동 불가
- 빙결: 행동 불가, 피격 시 해제
- 수면: 행동 불가, 피격 시 해제, 매 턴 HP 회복
- 혼란: 이동/공격 방향 랜덤
- 풀죽음: 기술 사용 불가 (기본공격만)
- 속박: 이동 불가

**버프** (4종):
- 칼춤: ATK 상승
- 방어: 1턴 데미지 무효
- 배리어: DEF/SPE_DEF 상승
- 가속: 1턴에 2회 행동

---

## 5. 포켓몬 활용 구조

> **모든 포켓몬이 역할을 가진다. 의미 없는 포켓몬은 없다.**

### 5-1. 플레이어 팀 (최대 3마리)

```
┌──────────────────────────────┐
│  리더 (직접 조작)             │
│  + 동료1 (AI, 전술 설정 가능) │
│  + 동료2 (AI, 전술 설정 가능) │
└──────────────────────────────┘
```

- **리더**: 직접 조작. 이동/기술/아이템 모두 선택
- **동료**: AI 자동 행동. 전술 설정:
  - 공격적 / 신중하게 / 따라오기 / 거리 유지

### 5-2. 모든 포켓몬의 존재 이유

| 역할 | 예시 | 왜 의미 있는가 |
|------|------|---------------|
| **스타터** (~30종) | 피카츄, 이브이, 리오루 | 각각 고유 패시브가 있어 런 스타일이 달라짐 |
| **동료 후보** (~400종) | 던전 내 모집 가능 | 파티 조합으로 시너지 타입 보너스 발동 |
| **일반 적** (~400종) | 던전 출현 | 처치 시 도전과제 진행 + 드랍 아이템 |
| **보스** (~30종) | 전설/환상 | 첫 클리어 보상 + 스타터 해금 조건 |
| **진화체** (~300종) | 모집→진화 | 상위 스탯 + 새 기술풀. 진화 도전과제 |

**핵심**: "일반 적 전용"이라는 카테고리를 없앤다. 모든 적 포켓몬은 모집 가능하거나, 처치 시 도전과제에 기여하거나, 특정 아이템을 드랍한다.

### 5-3. 시너지 보너스 (파티 타입 조합)

팀 내 같은 타입이 겹치면 시너지 발동:

| 겹침 수 | 효과 |
|:------:|------|
| 2마리 | 해당 타입 기술 데미지 +10% |
| 3마리 | 해당 타입 기술 데미지 +20%, 상태이상 내성 |

→ 동료 모집의 전략적 이유를 부여. "아무나 모집"이 아니라 "타입 조합을 고려한 모집"

### 5-4. 동료 모집 시스템

- 적 포켓몬을 **리더가 마지막 일격**으로 쓰러뜨리면 모집 판정
- 모집률:

| 레어도 | 기본 모집률 |
|--------|:---------:|
| COMMON | 12% |
| UNCOMMON | 8% |
| RARE | 4% |
| EPIC | 1.5% |
| ULTRA | 0.5% |

- 모집 성공 시 해당 런에서 바로 합류 (동료 3마리 초과 시 교체 선택)
- 실패해도 **도감에 "목격" 등록**

### 5-5. 진화 시스템

| 진화 유형 | 조건 | 예시 |
|-----------|------|------|
| 레벨 진화 | 특정 레벨 도달 | 파이리 Lv16 → 리자드 |
| 아이템 진화 | 진화석 사용 | 피카츄 + 천둥의돌 → 라이츄 |
| 조건 진화 | 도전과제 달성 | 이브이 + "물 던전 5회 클리어" → 샤미드 |

- 진화는 **마을에서만** 가능
- 진화 시 스프라이트/스탯/기술풀 변경

---

## 6. 해금 시스템 (RoR2 참고)

> **RoR2 핵심 원칙**: "해금은 도전과제로. 플레이하면 자연스럽게 열린다."

### 6-1. 설계 원칙

1. **모든 해금은 도전과제로 연결**: 단순 "N번 플레이"가 아니라 구체적 행동 목표
2. **도전과제 진행은 영구**: 사망해도, 다른 런에서도 누적됨
3. **해금 알림은 즉시**: 조건 달성 순간 화면에 "해금!" 알림 (RoR2 스타일)
4. **도전과제 자체가 튜토리얼**: 초반 도전과제가 게임 메카닉을 자연스럽게 가르침

### 6-2. 스타터 해금 (RoR2 캐릭터 해금 참고)

처음 5종만 선택 가능. 나머지는 **플레이 중 자연스럽게 달성되는 도전과제**로 해금.

| 스타터 | 타입 | 해금 조건 | RoR2 대응 |
|--------|------|----------|-----------|
| **피카츄** | 전기 | 기본 해금 | 커맨도 |
| **이상해씨** | 풀/독 | 기본 해금 | 커맨도 |
| **파이리** | 불 | 기본 해금 | 커맨도 |
| **꼬부기** | 물 | 기본 해금 | 커맨도 |
| **이브이** | 노말 | 기본 해금 | 헌트리스 |
| **리오루** | 격투 | 아무 던전 3회 클리어 | MUL-T (5회 텔레포터) |
| **치코리타** | 풀 | 동료 10마리 모집 누적 | 엔지니어 (30스테이지) |
| **브케인** | 불 | 보스에게 약점 기술로 막타 | 밴딧 (3스테이지 무사) |
| **리아코** | 물 | 물 타일 20칸 이상 이동 (누적) | REX (특수 조건) |
| **나옹** | 노말 | 골드 5,000 누적 획득 | 아티피서 (월화 코인) |
| **이상해꽃** | 풀/독 | 이상해씨를 진화시켜라 | 캡틴 (게임 클리어) |
| **갸라도스** | 물/비행 | 잉어킹으로 던전 클리어 | 머시너리 (오벨리스크) |
| **팬텀** | 고스트/독 | 벽 통과 100칸 누적 | 로더 (보스 처치) |
| **메타그로스** | 강철/에스퍼 | 후반 던전 아무거나 클리어 | 캡틴 |
| **루카리오** | 격투/강철 | 리오루로 보스 3종 클리어 | 풀스슨 (조건부) |
| **압솔** | 어둠 | 함정 50개 밟기 누적 | 어크리드 (보이드) |
| **님피아** | 요정 | 이브이를 진화시켜라 | 헤러틱 (월화 아이템) |
| **한카리아스** | 드래곤/땅 | 3마리 풀 파티로 5회 클리어 | 셰프 (누적 기여) |
| **미뇽** | 드래곤 | 도감 100종 목격 | - |
| **요루노즈쿠** | 노말/비행 | 밤 날씨에서 10층 탐험 누적 | - |
| **마릴** | 물/요정 | 동료 없이 솔로 던전 클리어 | - |
| **에이스번** | 불 | 한 런에서 기술 100회 사용 | - |
| **거북왕** | 물 | 한 런에서 데미지 500 이상 방어 | - |
| **레쿠쟈** | 드래곤/비행 | 모든 초반+중반 던전 클리어 | - |
| **뮤** | 에스퍼 | 모든 보스 클리어 | - |

**스타터 패시브** (각 스타터의 존재 이유):
| 스타터 | 패시브 | 플레이스타일 |
|--------|--------|------------|
| 피카츄 | 정전기: 인접 적 10% 마비 | 안정적 올라운더 |
| 이상해씨 | 엽록소: 맑음에서 Speed+30 | 날씨 활용형 |
| 파이리 | 맹화: HP 25% 이하 시 불 기술 ×1.5 | 하이리스크 화력형 |
| 꼬부기 | 급류: HP 25% 이하 시 물 기술 ×1.5 | 안정적 탱커 |
| 이브이 | 적응력: 자속보정 ×1.5→×2.0 | 진화 전 강력 |
| 갸라도스 | 위협: 전투 시작 시 적 ATK -10% | 파티 서포트형 |
| 팬텀 | 부유: 함정 무효 | 탐색 특화 |
| 압솔 | 대운: 크리티컬 확률 +15% | 일격필살형 |
| 레쿠쟈 | 에어로크: 날씨 효과 무효 | 만능 탐험가 |
| 뮤 | 변환: 매 층 랜덤 기술 1개 추가 | 카오스 빌드 |

→ **같은 던전이라도 스타터에 따라 전혀 다른 경험** = 리플레이 가치

### 6-3. 아이템 해금 (RoR2 아이템 드랍풀 참고)

> RoR2: 아이템을 해금해야 드랍풀에 추가됨. 해금 전엔 절대 등장 안 함.

**처음엔 기본 아이템만 등장. 도전과제로 해금하면 드랍풀에 추가.**

| 아이템 티어 | 기본 해금 | 도전과제 해금 | 총 |
|-----------|:---------:|:----------:|:---:|
| 소모품 (열매/씨앗/오브) | 15종 | +15종 | 30 |
| 장비 (스카프/밴드) | 5종 | +15종 | 20 |
| TM (기술머신) | 10종 | +20종 | 30 |

해금 아이템 예시:

| 아이템 | 해금 도전과제 | 왜 의미 있는가 |
|--------|-------------|--------------|
| 부활씨 | "전투불능에서 3회 부활" | 생존 보험 |
| 폭발씨 | "몬스터하우스 클리어 5회" | 광역 대응 |
| 기합의띠 | "HP 1로 생존 10회" | 극한 생존 |
| TM 냉동빔 | "얼음 타입 적 50마리 처치" | 강력 원거리 기술 |
| TM 지진 | "땅 던전 모두 클리어" | 광역 필살기 |
| 행운의리본 | "같은 포켓몬 5마리 모집 누적" | 모집률 +15% |
| 회복스카프 | "총 HP 회복량 10,000 달성" | 매턴 HP +5 |
| 날쌘발톱 | "Speed 100 이상으로 10층 클리어" | Speed +20 장비 |

### 6-4. 던전 해금

| 던전 | 해금 조건 | 보스 |
|------|----------|------|
| **해변동굴** | 기본 해금 | 갸라도스 |
| **작은초원** | 기본 해금 | 로즈레이드 |
| **천둥파동동굴** | 해변동굴 OR 작은초원 클리어 | 에레키블 |
| **크리스탈동굴** | 초반 던전 2개 클리어 | 크레세리아 |
| **마그마동굴** | 초반 던전 2개 클리어 | 그란돈 |
| **안개숲** | 초반 던전 2개 클리어 | 다크라이 |
| **시간의탑** | 중반 던전 2개 클리어 | 디아루가 |
| **공간의균열** | 중반 던전 2개 클리어 | 펄기아 |
| **숨겨진고원** | 중반 던전 2개 클리어 | 아르세우스 |
| **순수의숲** | 모든 후반 던전 클리어 | 뮤 |

> 항상 선택지가 2개 이상. "이 던전이 안 되면 저 던전으로" → 데드엔드 없음

### 6-5. 시설 해금 (마을 확장)

시설도 처음부터 다 열려있지 않다. 자연스러운 진행에 따라 해금:

| 시설 | 해금 조건 | 용도 |
|------|----------|------|
| 자기방 | 기본 | 팀 편성, 기술 교체 |
| 던전 입구 | 기본 | 던전 선택/출발 |
| 도감 | 기본 | 수집 현황, 도전과제 |
| 상점 | 첫 던전 클리어 | 아이템 구매/판매 |
| 창고 | 아이템 20개 보유 | 아이템 보관 (확장 가능) |
| 진화의동굴 | 진화 가능 포켓몬 보유 | 진화 수행 |
| 훈련장 | 포켓몬 5종 보유 | 골드로 레벨업 |
| 연결오브장인 | 중반 던전 1개 클리어 | 장비 강화/조합 |

### 6-6. 난이도 모드 해금

| 모드 | 해금 조건 | 효과 |
|------|----------|------|
| 보통 | 기본 | 기본 난이도 |
| 어려움 | 보통으로 5개 던전 클리어 | 적 레벨 +20%, 보상 +30% |
| 몬순 | 어려움으로 3개 던전 클리어 | 적 레벨 +50%, 보상 +60%, 함정 2배 |
| 순수 | 모든 던전 몬순 클리어 | Lv.1 시작, 아이템 반입 불가 |

→ **같은 10개 던전이 난이도 ×4 = 40개 다른 경험**

### 6-7. 도전과제 카테고리 총정리

| 카테고리 | 예시 | 해금 대상 | 수량 |
|----------|------|----------|:----:|
| **탐험** | "총 1,000층 탐험" | 스타터, 장비 | ~15 |
| **전투** | "효과 굉장 100회" | 아이템, TM | ~20 |
| **수집** | "도감 50종 모집" | 스타터, 시설 | ~15 |
| **특수** | "잉어킹으로 클리어" | 희귀 스타터 | ~10 |
| **던전** | "해변동굴 클리어" | 다음 던전, 시설 | ~10 |
| **마스터리** | "몬순 X 클리어" | 코스튬, 칭호 | ~10 |
| **합계** | | | **~80** |

---

## 7. 아이템 시스템

### 아이템 존재 이유 매트릭스

> **모든 아이템에는 "이걸 왜 쓰는가"가 있어야 한다.**

| 카테고리 | 종류 수 | 런 내 역할 | 메타 역할 |
|----------|:------:|-----------|----------|
| **열매** | 10 | 즉시 효과 (HP회복, 상태이상해제) | 도전과제 소재 |
| **씨앗** | 8 | 적에게 투척 (수면, 혼란, 폭발) | 전략적 선택지 |
| **오브** | 6 | 방 전체 효과 (빛, 바람, 워프) | 위기탈출 |
| **장비** | 20 | 영구 스탯 보정 (1인 1개) | 빌드 정의 |
| **TM** | 30 | 기술 가르침 (소모) | 빌드 확장 |
| **진화석** | 10 | 마을에서 진화용 | 수집/진화 진행 |
| **탈출오브** | 1 | 즉시 마을 귀환 | 안전장치 |

### 장비 시스템 (빌드 정의)

장비가 플레이스타일을 결정한다:

| 장비 | 효과 | 빌드 방향 |
|------|------|----------|
| 힘의머리띠 | ATK +10 | 물리 딜러 |
| 특공안경 | 기술 위력 +15% | 기술 의존형 |
| 회복스카프 | 매 턴 HP +3 | 탱커/지구전 |
| 날쌘발톱 | Speed +20 | 속공/더블턴 |
| 기합의띠 | HP 1 이하로 안 떨어짐 (1회) | 유리대포 |
| 행운의리본 | 모집률 +15% | 수집 특화 |
| 스코프렌즈 | 크리티컬 확률 +15% | 크리티컬 빌드 |
| 친화의리본 | 동료 AI 강화 | 파티 의존형 |
| 불면스카프 | 수면/빙결 면역 | 안티 상태이상 |
| 궁극의리본 | 전 스탯 +5 | 만능형 (최고급) |

### 배고픔 시스템
- 배고픔 게이지: 0~100
- 이동 1턴당 -0.15 (7층 × ~100턴 = 약 105턴 → 사과 1개면 충분)
- 배고픔 0: 매 턴 HP -2
- 층당 사과 1개 보장 드랍 → **배고픔으로 데드엔드 안 됨**

---

## 8. 던전 설계

### 8-1. 공통 구조 (모든 던전 7층)

```
1F: 입문 — 적 3~5마리, 아이템 3~4개 (사과 보장)
2F: 본격 — 적 5~7마리, 아이템 2~3개
3F: 변화 — 날씨 변경, 적 7~9마리
4F: 심화 — 몬스터하우스 or 상점 (택1, 25%씩)
5F: 고조 — 적 9~12마리, 강화 적 등장
6F: 정점 — 적 12~15마리, 희귀 아이템 확률 증가
7F: 보스 — 보스 1마리 + 부하 2~4마리
```

→ 7층 고정으로 10분 사이클 보장

### 8-2. 난이도 조절 방식 (층 수가 아니라 내용으로)

| 던전 등급 | 적 기본 레벨 | 적 밀도 | 아이템 품질 |
|----------|:-----------:|:------:|:---------:|
| 초반 (3개) | 5~15 | 낮음 | 일반 |
| 중반 (3개) | 15~30 | 보통 | 고급 포함 |
| 후반 (3개) | 30~50 | 높음 | 고급+희귀 |
| 엔드 (1개) | 50~70 | 매우 높음 | 최고급 |

### 8-3. 절차적 던전 생성

```
rot.js 던전 생성 (방+복도)
    ↓
TerrainType[][] 배열 (WALL/GROUND/WATER)
    ↓
Masker.mask8bits() (47-state 오토타일링)
    ↓
Tileset.getTileId() (타일 ID 계산)
    ↓
Tiled JSON → Phaser 3 렌더링
```

- 맵 크기: **24×18 타일** (7층 기준으로 더 압축, 층당 빠른 탐색)
- 방 4~8개, 복도로 연결
- 계단은 시작점에서 가장 먼 방에 배치

### 8-4. 던전 목록 (10개, 타일셋 98종에서 선별)

| # | 던전 | 타일셋 | 시너지 | 보스 | 출현 적 예시 |
|:-:|------|--------|--------|------|------------|
| 1 | 해변동굴 | BeachCave | 물/땅/화석 | 갸라도스 | 코다크,크랩,디그다 |
| 2 | 작은초원 | TinyMeadow | 풀/벌레/요정 | 로즈레이드 | 이상해풀,파라스,삐삐 |
| 3 | 천둥파동동굴 | ThunderwaveCave | 전기/강철/바위 | 에레키블 | 피카츄,코일,꼬마돌 |
| 4 | 크리스탈동굴 | CrystalCave1 | 에스퍼/소리/요정 | 크레세리아 | 유니란,푸린,랄토스 |
| 5 | 마그마동굴 | MagmaCavern3 | 불/땅/바위 | 그란돈 | 마그비,디그다,코터스 |
| 6 | 안개숲 | FoggyForest | 풀/독/고스트 | 다크라이 | 로젤리아,고오스,독파리 |
| 7 | 시간의탑 | TemporalTower | 강철/에스퍼/드래곤 | 디아루가 | 메타그로스,에브이,미뇽 |
| 8 | 공간의균열 | SpacialRift1 | 드래곤/어둠/고스트 | 펄기아 | 한카리아스,블래키,팬텀 |
| 9 | 숨겨진고원 | HiddenHighland | 비행/격투/빛 | 아르세우스 | 보만다,루카리오,토게키스 |
| 10 | 순수의숲 | PurityForest | 랜덤 3종 | 뮤 | 랜덤 (매 런 변경) |

### 8-5. 날씨 시스템

3F부터 날씨 발동 (던전 시너지와 연동):

| 날씨 | 시각 효과 | 게임 효과 |
|------|----------|----------|
| 맑음 | 밝은 조명 | 풀 +20% |
| 비 | 빗방울 파티클 | 물 +20%, 불 -20% |
| 모래바람 | 모래 파티클 | 바위/땅/강철 DEF+2 |
| 눈 | 눈 파티클 | 얼음 +20% |
| 안개 | 안개 오버레이 | 시야 -1, 요정 +20% |
| 밤 | 어두운 틴트 | 어둠/고스트 +20% |

→ 날씨가 "이 던전에 어떤 타입을 데려갈까" 고민을 유발 = 전략 요소

---

## 9. 마을 (허브)

### 시설 (해금 순서대로)

```
┌──────────────────────────────────┐
│            마 을                   │
│                                  │
│  🏠 자기방 (기본)                 │
│  팀 편성 / 기술 교체 / 도전과제    │
│                                  │
│  🚪 던전 입구 (기본)              │
│  던전 선택 / 난이도 선택           │
│                                  │
│  📖 도감 (기본)                   │
│  포켓몬 목격/포획/진화 현황        │
│                                  │
│  🏪 상점 (첫 클리어 후)           │
│  소모 아이템 구매/판매             │
│                                  │
│  📦 창고 (아이템 20개 보유 후)     │
│  장비/진화석/TM 보관              │
│                                  │
│  🔮 진화의동굴 (진화가능 시)       │
│  진화 수행                        │
│                                  │
│  ⚔️ 훈련장 (5종 보유 후)         │
│  골드로 경험치 구매                │
│                                  │
│  🔧 연결오브장인 (중반 진입 후)    │
│  장비 강화/조합                    │
└──────────────────────────────────┘
```

### 재화

| 재화 | 획득 | 용도 |
|------|------|------|
| **골드** | 던전 드랍, 아이템 판매 | 상점, 훈련장, 장비 강화 |

> 재화를 1종으로 단순화. "보스 코어", "별의파편" 등 복수 재화 제거.
> 이유: 재화가 많으면 "이건 뭐에 쓰지?" 혼란 발생. 골드 하나로 통합.

---

## 10. 메타 진행 설계

### 영구 진행 요소 (죽어도 유지)

| 요소 | 설명 |
|------|------|
| 모집한 포켓몬 | 영구 보유 |
| 도전과제 진행도 | 누적 (사망 포함) |
| 해금 (스타터/아이템/던전/시설) | 영구 |
| 골드 | 클리어 시 100% / 사망 시 50% 보존 |
| 장비 | 장착 중인 장비는 사망해도 유지 |
| 도감 | 영구 |

### 런 내 요소 (사망 시 리셋)

| 요소 | 설명 |
|------|------|
| 소모 아이템 (열매/씨앗/오브) | 사망 시 전부 유실 |
| 층 진행 | 1F부터 다시 |
| 동료 레벨 | 런 중 올린 레벨은 유지 (사망 페널티 -3레벨) |

### 사망 페널티가 "적절한" 이유

- 잃는 것: 소모 아이템 (다시 줍기 쉬움), 약간의 골드, 약간의 레벨
- 남는 것: 포켓몬, 장비, 도전과제, 해금, 도감
- → "죽어도 다음 런이 기대되는" 밸런스

---

## 11. 모바일 UX 설계

### 화면 레이아웃 (세로 모드, 360×640 기준)

```
┌────────────────────────────┐
│ B3F     HP ████░░  🍎 72   │ ← HUD
│ Lv.12   PP ████░░░         │
├────────────────────────────┤
│                            │
│                            │
│         [게임 화면]         │ ← 맵 (카메라 추종)
│        탭/스와이프 조작      │
│                            │
│                            │
│                            │
├────────────────────────────┤
│ [기술1][기술2][기술3][기술4]│ ← 기술
│ [가방]  [팀]  [대기] [자동] │ ← 메뉴
└────────────────────────────┘
```

### 조작

| 조작 | 동작 |
|------|------|
| 맵 탭 | 빈 타일 = 이동, 적 = 공격 |
| 스와이프 | 방향 이동 1칸 |
| 길게 탭 | 자동 이동 (적 만나면 정지) |
| 기술 버튼 | 기술 사용 → 방향 선택 |
| 가방 | 인벤토리 오버레이 |
| 팀 | 동료 현황/전술 |
| 대기 | 턴 스킵 |
| 자동 | 미탐색 영역으로 자동 이동 |

### 해금 알림 UI (RoR2 스타일)

```
┌────────────────────────────┐
│                            │
│    ╔══════════════════╗    │
│    ║  🔓 도전과제 달성! ║    │
│    ║                  ║    │
│    ║  "아무 던전 3회   ║    │
│    ║   클리어"        ║    │
│    ║                  ║    │
│    ║  → 리오루 해금!   ║    │
│    ╚══════════════════╝    │
│                            │
│         [확인]             │
└────────────────────────────┘
```
→ 런 종료 대기 없이 **달성 즉시** 알림. 다음 런부터 사용 가능.

---

## 12. 의미 없는 요소 점검표

> **기획 단계에서 "이게 왜 있지?" 체크리스트**

| 요소 | 존재 이유 | 없으면? |
|------|----------|--------|
| 배고픔 시스템 | 층당 시간 제한 + 탐색 긴장감 | 한 층에서 무한 레벨링 가능 → 난이도 붕괴 |
| 타입 상성 | 파티 조합의 전략적 이유 | 아무 포켓몬이나 쓰면 됨 → 1,200종 무의미 |
| 시너지 보너스 | 동료 모집의 전략적 이유 | 강한 것만 모집 → 다양성 없음 |
| 날씨 | 던전별 파티 편성 고민 | 매번 같은 팀으로 돌리면 됨 |
| 장비 | 빌드 다양성 | 모든 런이 같은 느낌 |
| 난이도 모드 | 리플레이 가치 × 4 | 한 번 클리어하면 끝 |
| 동료 AI 전술 | 플레이어 개입 여지 | 동료가 멍청하면 짜증 |
| 도전과제 | 장기 목표 + 해금 동기 | "다음엔 뭐하지?" 없음 |
| 탈출오브 | 데드엔드 방지 | 죽는 것 외에 탈출 불가 → 좌절 |
| 자동이동 | 10분 맞추기 | 복도 이동이 너무 지루 |

**제거된 요소 (이전 버전에서 삭제):**
- ~~매혹 상태이상~~: 수면/빙결과 역할 중복
- ~~저주 상태이상~~: 독과 역할 중복, 과도한 디버프
- ~~부활 버프~~: 기합의띠 장비와 중복
- ~~보스 코어 / 별의파편 재화~~: 골드 하나로 충분
- ~~쥬크박스 시설~~: MVP에 불필요. 나중에 추가 가능
- ~~교환소 시설~~: 복수 재화 제거로 불필요
- ~~스택 진화~~: 오토체스 감성이라 던전 크롤러와 안 맞음
- ~~심층 던전 50~99층~~: 10분 사이클과 모순. 대신 "순수 모드"로 대체

---

## 13. 기술적 아키텍처

### 기술 스택

| 구분 | 기술 | 용도 |
|------|------|------|
| 엔진 | Phaser 3 | 렌더링, 입력, 오디오, 타일맵 |
| 던전 생성 | rot.js | Digger/Uniform, FOV, A* |
| 언어 | TypeScript | 타입 안전성 |
| 오토타일링 | DTEF Masker (원본) | 47-state 비트마스크 |
| 저장 | localStorage | 메타 진행 (예상 ~50KB) |
| 배포 | GitHub Pages (PWA) | 정적 호스팅 |
| 빌드 | Vite | 빌드/HMR |

### 저장 구조

```typescript
interface SaveData {
  version: string
  gold: number
  pokedex: Record<PkmId, { seen: boolean; caught: boolean; evolved: boolean }>
  ownedPokemon: PokemonData[]      // 보유 포켓몬 목록
  team: { leader: string; members: string[] }  // 현재 팀
  challenges: Record<ChallengeId, { progress: number; completed: boolean }>
  unlocks: {
    starters: PkmId[]
    items: ItemId[]
    dungeons: DungeonId[]
    facilities: FacilityId[]
    difficulties: DifficultyId[]
  }
  facilityLevels: Record<FacilityId, number>
  storage: ItemData[]               // 창고 아이템
  settings: GameSettings
  stats: {                          // 통계 (도전과제 추적용)
    totalFloors: number
    totalKills: number
    totalDeaths: number
    totalGoldEarned: number
    totalRecruits: number
    bossesDefeated: string[]
    dungeonsCleared: string[]
  }
}
```

### 에셋 로딩 전략

```
게임 시작:   UI + 타입 아이콘 + 공통 이펙트
던전 진입:   타일셋 1종 + BGM 1트랙
층 진입:     출현 포켓몬 스프라이트 ~10종
팀 편성:     리더/동료 스프라이트 + 초상화
```

---

## 14. 개발 로드맵

### Phase 1: MVP (돌아가는 한 판)
1. Phaser 3 + Vite 프로젝트 세팅 (모바일 세로)
2. rot.js 던전 생성 → DTEF 오토타일링 → 타일맵 렌더링
3. 포켓몬 스프라이트 로드 + 8방향 이동 + 카메라
4. 턴 시스템 (이동/대기/기본공격)
5. 기본 전투 (HP/ATK/DEF + 타입상성)
6. 계단 + 7층 구조 + 보스
7. 해변동굴 1개 던전 플레이 가능

### Phase 2: 핵심 시스템
8. 기술 시스템 (4슬롯, PP, 범위 패턴 6종)
9. 아이템 (줍기/사용/인벤토리)
10. 동료 AI (3인 파티)
11. 동료 모집
12. 배고픔

### Phase 3: 메타 진행
13. 마을 허브 + 시설 (해금 순서대로)
14. localStorage 저장/불러오기
15. 도전과제 시스템 + 해금 연동
16. 도감
17. 진화

### Phase 4: 완성도
18. 던전 10개 + 날씨
19. 스타터 25종 + 패시브
20. 장비 20종 + TM 30종
21. 난이도 모드 4단계
22. BGM/SFX + PWA
23. 밸런싱/테스트

---

## 부록: 원본 레포 리소스 경로

```
스프라이트:      app/public/src/assets/pokemons/
초상화:         app/public/src/assets/portraits/
기술 이펙트:    app/public/src/assets/abilities{tps}/
투사체/피격:    app/public/src/assets/attacks{tps}/
상태이상:       app/public/src/assets/status{tps}/
타일셋:         app/public/src/assets/tilesets/
아이템 아이콘:   app/public/src/assets/item{tps}/
타입 아이콘:    app/public/src/assets/types/
날씨 파티클:    app/public/src/assets/environment/
사운드:         app/public/src/assets/sounds/

포켓몬 데이터:   app/models/colyseus-models/pokemon.ts
기술 로직:      app/core/abilities/abilities.ts
아이템 데이터:   app/types/enum/Item.ts
시너지:         app/types/enum/Synergy.ts
던전 매핑:      app/config/maps/regions.ts
오토타일링:     app/core/masker.ts + app/config/maps/tileset.ts
던전 생성:      app/core/design.ts + app/core/terrain.ts
애니메이션:     app/public/src/game/components/pokemon-animations.ts
프레임 타이밍:   app/types/delays.json
```
